# 第18章_主从复制

## 1. 主从复制概述

### 1.1 如何提升数据库并发能力

![image-20220906170619271](C:\Users\Yilin.Yang\AppData\Roaming\Typora\typora-user-images\image-20220906170619271.png)

此外，一般应用对数据库而言都是“ **读多写少** ”，也就说对数据库读取数据的压力比较大，有一个思路就 是采用数据库集群的方案，做 **主从架构** 、进行 **读写分离** ，这样同样可以提升数据库的并发处理能力。但 并不是所有的应用都需要对数据库进行主从架构的设置，毕竟设置架构本身是有成本的。

如果我们的目的在于提升数据库高并发访问的效率，那么首先考虑的是如何 **优化SQL和索引** ，这种方式 简单有效；其次才是采用 **缓存的策略** ，比如使用 Redis将热点数据保存在内存数据库中，提升读取的效 率；最后才是对数据库采用 主从架构 ，进行读写分离。

### 1.2 主从复制的作用

主从同步设计不仅可以提高数据库的吞吐量，还有以下 3 个方面的作用。

**第1个作用：读写分离。**

![image-20220906170857463](C:\Users\Yilin.Yang\AppData\Roaming\Typora\typora-user-images\image-20220906170857463.png)

**第2个作用就是数据备份。**

**第3个作用是具有高可用性。**

## 2. 主从复制的原理

**Slave** 会从 **Master** 读取 **binlog** 来进行数据同步。

### 2.1 原理剖析

**三个线程**

实际上主从同步的原理就是基于 binlog 进行数据同步的。在主从复制过程中，会基于 **3 个线程** 来操 作，一个主库线程，两个从库线程。

![image-20220906171239547](C:\Users\Yilin.Yang\AppData\Roaming\Typora\typora-user-images\image-20220906171239547.png)